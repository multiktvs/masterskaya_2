# Маркетинговое предсказание - Прогнозирование покупок клиентов

## Описание проекта

Интернет-магазин собирает историю покупателей, проводит рассылки предложений и планирует будущие продажи. Для оптимизации маркетинговых процессов необходимо выделить пользователей, которые готовы совершить покупку в ближайшее время.

Этот проект разрабатывает модель машинного обучения для предсказания вероятности покупки клиентом в течение **90 дней**.

## Цель

Предсказать вероятность того, что клиент совершит покупку в течение 90 дней на основе:
- История сообщений (рассылок)
- История покупок
- Информация о событиях и кампаниях
- Категории товаров, которые интересуют клиента

## Задачи проекта

1. **Исследовательский анализ данных (EDA)**
   - Загрузка и проверка структуры датасетов
   - Анализ пропусков и дубликатов
   - Статистический обзор числовых и категориальных переменных
   - Визуализация распределений и зависимостей

2. **Разработка полезных признаков (Feature Engineering)**
   - Расчет периодов между покупками
   - Создание признаков активности клиента
   - Определение любимых категорий товаров
   - Подсчет различных типов событий
   - Совмещение информации из разных источников

3. **Предобработка данных**
   - Удаление дубликатов и пропусков
   - Нормализация признаков
   - Удаление мультиколлинеарных признаков (VIF анализ)
   - Выбор топ-N самых важных признаков

4. **Построение моделей машинного обучения**
   - Реализация трех моделей: Logistic Regression, LightGBM, Random Forest
   - Оптимизация гиперпараметров с помощью Optuna
   - Выбор лучшей модели по метрике ROC-AUC
   - Интерпретация важности признаков

5. **Оценка и валидация**
   - Оценка качества на тестовых данных
   - Анализ ошибок предсказания
   - Интерпретация модели (SHAP values)

## Входные данные

### apparel-messages.csv
Информация о рассылках маркетинговых предложений клиентам.

**Колонки:**
- `client_id` - уникальный идентификатор клиента
- `date` - дата рассылки
- Другая релевантная информация о рассылке

### apparel-purchases.csv
История всех покупок клиентов.

**Колонки:**
- `client_id` - уникальный идентификатор клиента
- `date` - дата покупки
- `category_id` - категория товара
- `price` - цена товара
- `quantity` - количество товара

### apparel-target_binary.csv
Целевая переменная для обучения модели.

**Колонки:**
- `client_id` - уникальный идентификатор клиента
- `target` - 1 если клиент совершил покупку в течение 90 дней, 0 иначе

### full_campaign_daily_event
Агрегация общей базы рассылок по дням и типам событий

**Колонки:**
- дата
- идентификатор рассылки
- общее количество каждого события event
- количество уникальных client_id в каждом событии

### full_campaign_daily_event_channel.csv
Информация о маркетинговых событиях и кампаниях.

**Колонки:**
- Информация о типах событий
- Каналы коммуникации
- Даты и результаты событий

## Установка и запуск

### 1. Требования

- Python 3.8 или выше
- Jupyter Notebook или JupyterLab

### 2. Установка зависимостей

```bash
# Установите все необходимые пакеты
pip install -r requirements.txt
```

### 3. Запуск проекта

```bash
# Запустите Jupyter Notebook
jupyter notebook

# Откройте файл marketing_predict.ipynb
# Выполните все ячейки по порядку (Kernel → Run All)
```

## Используемые библиотеки

### Основные библиотеки

| Библиотека | Версия | Назначение |
|-----------|--------|-----------|
| **pandas** | ≥1.3.0 | Работа с табличными данными и DataFrames |
| **numpy** | ≥1.20.0 | Математические операции и работа с массивами |
| **scikit-learn** | ≥1.0.0 | Алгоритмы машинного обучения и метрики |
| **lightgbm** | ≥3.0.0 | Градиентный бустинг (LightGBM) |
| **matplotlib** | ≥3.8.4 | Создание графиков и визуализаций |
| **seaborn** | ≥0.13.2 | Статистические визуализации |
| **optuna** | ≥3.0.0 | Оптимизация гиперпараметров |
| **shap** | ≥0.40.0 | Интерпретация предсказаний моделей |

### Дополнительные библиотеки

- **statsmodels** - статистические модели
- **scipy** - научные вычисления

## Основные этапы анализа

### 1️ Загрузка и проверка данных

### 2️ Анализ пропусков и аномалий
- Поиск пропущенных значений
- Выявление дубликатов
- Проверка экстремальных значений

### 3️ Анализ признаков
- Расчет периодов между покупками
- Создание признаков активности
- Извлечение любимых категорий
- Подсчет событий по типам

### 4️ Объединение данных
- Комбинирование информации из разных источников
- Заполнение пропусков
- Выравнивание размерности

### 5️ Предобработка и отбор признаков
- Удаление мультиколлинеарности (VIF > 9)
- Выбор top-20 признаков по важности
- Нормализация данных

### 6️ Обучение моделей
- Разделение на обучение/тест (80/20)
- Обучение трех моделей
- Оптимизация гиперпараметров (Optuna, 20 пробных запусков)
- Оценка качества по ROC-AUC

### 7️ Интерпретация результатов
- Анализ важности признаков
- SHAP значения
- Выводы и рекомендации

## Ожидаемые результаты

Проект выдает:

1. **Обученные модели** - три готовые к использованию модели
2. **Предсказания** - вероятности покупки для каждого клиента на тестовом наборе
3. **Метрики качества** - ROC-AUC, Accuracy и другие показатели
4. **Анализ важности признаков** - какие факторы влияют на решение о покупке
5. **Визуализации** - графики распределений, зависимостей, важности признаков

##  Требуемые данные

Проект требует наличие в папке проекта четыре CSV файлами:
- `apparel-messages.csv`
- `apparel-purchases.csv`
- `apparel-target_binary.csv`
- `full_campaign_daily_event_channel.csv`

**Без этих файлов notebook не будет работать.** Убедитесь, что данные находятся в правильной папке.
